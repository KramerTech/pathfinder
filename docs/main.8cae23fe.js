parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"LpCL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class t{constructor(t=0,s=0){this.x=t,this.y=s,this.set(t,s)}static equals(t,s){return void 0!==t&&void 0!==s&&t.equals(s)}static add(s,i){return new t(s.x+i.x,s.y+i.y)}static addScalar(t,s){return t.clone().addScalar(s)}static sub(s,i){return new t(s.x-i.x,s.y-i.y)}static subScalar(t,s){return t.clone().subScalar(s)}static mult(s,i){return new t(s.x*i,s.y*i)}static div(s,i){return new t(s.x/i,s.y/i)}static dist(s,i){return Math.sqrt(t.distSq(s,i))}static distSq(s,i){return t.sq(i.x-s.x)+t.sq(i.y-s.y)}static mag(t,s){return Math.sqrt(t*t+s*s)}static magSq(t,s){return t*t+s*s}static normalize(t){return t.clone().normalize()}static min(t,s){return t.clone().min(s)}static max(t,s){return t.clone().max(s)}static floor(t){return t.clone().floor()}static ceil(t){return t.clone().ceil()}static clamp(t,s,i){return t.clone().clamp(s,i)}static sq(t){return t*t}static scale(s,i){return t.normalize(s).mult(i)}static round(t){return t.clone().round()}static cross(t,s){return t.cross(s)}static invert(t){return t.clone().mult(-1)}static toPolar(t){return t.clone().toPolar()}static toCartesian(t){return t.clone().toCartesian()}static fromAngle(s){return new t(Math.cos(s),Math.sin(s))}static rotate(t,s){return t.clone().rotate(s)}clone(){return new t(this.x,this.y)}equals(t){return this.x===t.x&&this.y===t.y}set(t,s){return"number"==typeof t?(this.x=t,this.y=s):(this.x=t.x,this.y=t.y),this}add(t,s){return"number"==typeof t?(this.x+=t,this.y+=s):(this.x+=t.x,this.y+=t.y),this}addScalar(t){return this.x+=t,this.y+=t,this}sub(t,s){return"number"==typeof t?(this.x-=t,this.y-=s):(this.x-=t.x,this.y-=t.y),this}subScalar(t){return this.x-=t,this.y-=t,this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,s){let i,r,h,e;if("number"==typeof t){if("number"!=typeof s)throw new Error("Invalid call signature");i=r=t,h=e=s}else{if("number"==typeof s)throw new Error("Invalid call signature");i=t.x,h=s.x,r=t.y,e=s.y}return this.x=Math.max(i,Math.min(this.x,h)),this.y=Math.max(r,Math.min(this.y,e)),this}angle(){return Math.atan2(this.y,this.x)}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}mult(t){return this.x*=t,this.y*=t,this}div(t){return this.x/=t,this.y/=t,this}dist(t){return Math.sqrt(this.distSq(t))}distSq(s){return s?t.sq(s.x-this.x)+t.sq(s.y-this.y):0}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}magSq(){return this.x*this.x+this.y*this.y}normalize(){const t=this.mag();return this.x/=t,this.y/=t,this}scale(t){return this.normalize().mult(t)}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}invert(){return this.mult(-1)}zero(){return this.x=0,this.y=0,this}rotate(t){let s=this.x*Math.cos(t)+this.y*Math.sin(t),i=this.y*Math.cos(t)-this.x*Math.sin(t);return this.x=s,this.y=i,this}toPolar(){const t=this.mag();return this.y=Math.atan2(this.y,this.x),this.x=t,this}toCartesian(){const t=this.x,s=this.y;return this.x=t*Math.cos(s),this.y=t*Math.sin(s),this}isZero(){return 0===this.x&&0===this.y}eitherIsZero(){return 0===this.x||0===this.y}toString(){return this.x+" "+this.y}index(t){return this.x+this.y*t}}exports.Vec=t,t.ZERO={x:0,y:0},t.TWO_PI=2*Math.PI;
},{}],"m88C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./util/vec");class I{}exports.Env=I,I.TARGET_SIZE=new e.Vec(1920,1080),I.GRID_SIZE=24,I.HALF_GRID_SIZE=I.GRID_SIZE/2,I.SHADOW=4,I.GRID_DIM=e.Vec.div(I.TARGET_SIZE,I.GRID_SIZE).ceil(),I.REQ_SIZE=e.Vec.mult(I.GRID_DIM,I.GRID_SIZE),I.scale=1,I.shifting=!1;
},{"./util/vec":"LpCL"}],"oVEU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./vec"),e=require("../env");class s{static radians(t){return t*this.radToDeg}static rayIntersection(e,s,n,r){const o=t.Vec.sub(s,e).cross(t.Vec.sub(r,n));if(0===o)return;const i=e.cross(s),c=n.cross(r);return new t.Vec((i*(n.x-r.x)-c*(e.x-s.x))/o,(i*(n.y-r.y)-c*(e.y-s.y))/o)}static pointInSegment(t,e,n){return n.x>=Math.min(t.x,e.x)-s.ERR&&n.x<=Math.max(t.x,e.x)+s.ERR&&n.y>=Math.min(t.y,e.y)-s.ERR&&n.y<=Math.max(t.y,e.y)+s.ERR}static segmentIntersectionPoint(t,e,s,n){const r=this.rayIntersection(t,e,s,n);if(r&&this.pointInSegment(t,e,r)&&this.pointInSegment(s,n,r))return r}static rayCast(e,s,n,r){for(const o of r)for(const r of this.RECT_SEGS){const i=new t.Vec(o.pos.x+r[0],o.pos.y+r[1]),c=new t.Vec(o.pos.x+r[2],o.pos.y+r[3]),a=t.Vec.sub(e,s);a.set(-a.y,a.x),a.normalize(),a.mult(n);const u=t.Vec.add(e,a),x=t.Vec.add(s,a);if(this.segmentIntersectionPoint(u,x,i,c))return o;if(a.mult(2),u.sub(a),x.sub(a),this.segmentIntersectionPoint(u,x,i,c))return o}}}exports.Util=s,s.ERR=.001,s.RECT_SEGS=[[-1,-1,-1,1],[-1,-1,1,-1],[-1,1,1,1]],s.radToDeg=Math.PI/180,s.RECT_SEGS.forEach(t=>t.forEach((s,n)=>{t[n]=s*e.Env.HALF_GRID_SIZE}));
},{"./vec":"LpCL","../env":"m88C"}],"Yf8M":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../env");class s{constructor(e,s){this.index=e,this.pos=s,this.f=0,this.h=0,this.g=0,this.valid=!0,this.edges=[],this.weights=[],this.obstacles=[]}clearEdges(){this.edges.length=0,this.weights.length=0}edge(e,s){this.edges.push(e),this.weights.push(s)}doubleEdge(e,s){this.edge(e,s),e.edge(this,s)}equals(e){return e instanceof s&&this.pos.equals(e.pos)}compareTo(e){let s=this.f-e.f;return 0!=s?s:this.h-e.h}calcF(){this.f=this.g+this.h}draw(s){s.fillStyle="#a200cc",s.beginPath(),s.moveTo(-e.Env.HALF_GRID_SIZE,e.Env.HALF_GRID_SIZE),s.lineTo(-e.Env.HALF_GRID_SIZE-e.Env.SHADOW,e.Env.HALF_GRID_SIZE-e.Env.SHADOW),s.lineTo(e.Env.HALF_GRID_SIZE-e.Env.SHADOW,-e.Env.HALF_GRID_SIZE-e.Env.SHADOW),s.lineTo(e.Env.HALF_GRID_SIZE,-e.Env.HALF_GRID_SIZE),s.lineTo(e.Env.HALF_GRID_SIZE,e.Env.HALF_GRID_SIZE),s.fill(),s.fillStyle="#b200ff",s.fillRect(-e.Env.HALF_GRID_SIZE-e.Env.SHADOW,-e.Env.HALF_GRID_SIZE-e.Env.SHADOW,e.Env.GRID_SIZE,e.Env.GRID_SIZE)}}exports.GraphNode=s;
},{"../env":"m88C"}],"uJIP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("../util/vec");class i{constructor(i){this.pos=i,this.vel=new t.Vec,this.rotation=0,this.acceleration=new t.Vec(0,0),this.deltaRotation=0,this.behaviors=[]}applyDeltas(){this.rotation+=this.deltaRotation,this.deltaRotation=0,this.rotation>Math.PI?this.rotation-=2*Math.PI:this.rotation<=-Math.PI&&(this.rotation+=2*Math.PI),this.vel.add(this.acceleration),this.acceleration.mult(0),this.pos.add(this.vel)}rotate(t){this.deltaRotation+=t}accelerate(t){this.acceleration.add(t)}setBehaviors(...t){return this.behaviors=t,this}addBehavior(t){this.behaviors.push(t)}applyBehaviors(t){this.behaviors.forEach(i=>i.apply(this,t))}}exports.Entity=i;
},{"../util/vec":"LpCL"}],"ZD7m":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./entity"),i=require("../util/util"),s=require("../util/vec");class e extends t.Entity{constructor(t=new s.Vec,r=e.DEFAULT_SIZE,o="black"){super(t),this.radius=r,this.color=o,this.diameter=2*this.radius,this.tx=this.radius*Math.cos(i.Util.radians(60)),this.ty=this.radius*Math.sin(i.Util.radians(60))}draw(t){t.fillStyle=this.color,t.beginPath(),t.ellipse(0,0,this.radius,this.radius,0,0,2*Math.PI),t.rotate(this.rotation),t.moveTo(this.tx,-this.ty),t.lineTo(this.diameter,0),t.lineTo(this.tx,this.ty),t.fill()}clone(){const t=new e(this.pos.clone(),this.radius,this.color);return t.rotation=this.rotation,t}setPosition(t){this.pos.set(t),this.vel.zero()}}exports.Boid=e,e.DEFAULT_SIZE=6;
},{"./entity":"uJIP","../util/util":"oVEU","../util/vec":"LpCL"}],"O8qb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class s{constructor(){this.subBehaviors=[]}addSubBehavior(s){this.subBehaviors.push(s)}applySubBehaviors(s,t){this.subBehaviors.forEach(e=>e.apply(s,t))}}exports.Behavior=s;class t extends s{constructor(s=1){super(),this._strength=s,this.setStrength(s)}setStrength(s){this._strength=s,this.subBehaviors&&this.subBehaviors.forEach(e=>{e instanceof t&&e.setStrength(s)})}get strength(){return this._strength}}exports.BlendableBehavior=t;
},{}],"Wd1d":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./behavior"),t=require("../util/vec");class r extends e.BlendableBehavior{constructor(e,r){super(r),this._target=new t.Vec,this.target=e}get target(){return this._target.clone()}set target(e){this._target.set(e)}apply(e){let r;r=e.pos.dist(this._target)<1.5?t.Vec.invert(e.vel):t.Vec.sub(this._target,e.pos).sub(e.vel).normalize().mult(this.strength),e.accelerate(r)}}exports.SeekTarget=r;
},{"./behavior":"O8qb","../util/vec":"LpCL"}],"cESq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(){this.queue=[]}get length(){return this.queue.length}enqueueAll(...e){e.forEach(e=>this.enqueue(e))}enqueue(e){this.queue.push(e),this.queue.length>1&&this.siftUp(e)}dequeue(){const e=this.queue[0],t=this.queue[this.queue.length-1];return--this.queue.length>0&&this.siftDown(t),e}peek(){return this.queue[0]}remove(e){const t=this.queue.indexOf(e);return!(t<0)&&(this.removeAt(t),!0)}removeAt(e){const t=this.queue[this.queue.length-1];e<--this.queue.length&&(this.siftDown(t,e),this.queue[e]==t&&this.siftUp(t,e))}clear(){this.queue.length=0}siftUp(e,t=this.queue.length-1){for(;t>0;){const u=t-1>>>1,s=this.queue[u];if(e.compareTo(s)>=0)break;this.queue[t]=s,t=u}this.queue[t]=e}siftDown(e,t=0){const u=this.queue.length>>>1;for(;t<u;){let u=1+(t<<1);const s=u+1;let h=this.queue[u];if(s<this.queue.length&&h.compareTo(this.queue[s])>0&&(u=s,h=this.queue[u]),e.compareTo(h)<=0)break;this.queue[t]=h,t=u}this.queue[t]=e}}exports.PriorityQueue=e;
},{}],"d3Yy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./pq");class t{constructor(t,s){this.start=t,this.goal=s,this.open=new e.PriorityQueue,this.opened=new Set,this.closed=new Set,t.g=0,t.h=this.heuristic(t,s),t.calcF(),delete t.parent,this.open.enqueue(t)}heuristic(e,t){return e.pos.dist(t.pos)}solve(){for(;;){if(this.closed.has(this.goal))return void this.pathBack();if(!this.open.length)return;let e=this.open.dequeue();this.closed.add(e),e.edges.forEach((t,s)=>{this.closed.has(t)||(this.opened.has(t)?e.g+e.weights[s]<t.g&&(this.open.remove(t),t.g=e.g+e.weights[s],t.calcF(),t.parent=e,this.open.enqueue(t)):(t.g=e.g+e.weights[s],t.h=this.heuristic(t,this.goal),t.calcF(),t.parent=e,this.open.enqueue(t),this.opened.add(t)))})}}pathBack(){this.path=[];const e=[];let t=this.goal;for(;t;)e.push(t),t=t.parent;for(;e.length;)this.path.push(e.pop())}}exports.Algorithm=t;
},{"./pq":"cESq"}],"f1UR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const s=require("./behavior");class t extends s.Behavior{constructor(s=t.BUFFER_DISTANCE,e=20,i=t.CRUMB_SCALE){super(),this.bufferDist=s,this.max=e,this.scale=i,this.distTracker=0,this.crumbs=[]}clear(){this.crumbs.length=0}apply(s){this.last?(this.distTracker+=s.pos.dist(this.last),this.distTracker>this.bufferDist&&(this.crumbs.push(s.clone()),this.distTracker-=this.bufferDist),this.last.set(s.pos),this.max>0&&this.crumbs.length>this.max&&this.crumbs.splice(0,1)):this.last=s.pos.clone()}draw(s,t){const e=1/this.max;let i=(this.max-this.crumbs.length)*e;i-=e*(this.distTracker/this.bufferDist),this.crumbs.forEach(r=>{i+=e,s.save(),s.globalAlpha=i,s.translate(r.pos.x,r.pos.y),s.scale(this.scale,this.scale),r.draw(s,t),s.restore()})}}exports.BreadCrumbs=t,t.BUFFER_DISTANCE=40,t.CRUMB_SCALE=.5;
},{"./behavior":"O8qb"}],"LsDi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./behavior"),t=require("../util/vec");class r extends e.Behavior{apply(e){if(0==e.vel.magSq())return;let r=e.vel.angle()-e.rotation;r>Math.PI?r-=t.Vec.TWO_PI:r<=-Math.PI&&(r+=t.Vec.TWO_PI),e.rotate(r)}}exports.AlignToVelocity=r;
},{"./behavior":"O8qb","../util/vec":"LpCL"}],"a041":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./behavior"),e=require("../util/vec");class a extends t.Behavior{constructor(t=0){super(),this.cap=t}get cap(){return this._cap}set cap(t){this._cap=t,this.capSq=t*t}apply(t){const a=e.Vec.add(t.vel,t.acceleration);a.magSq()>this.capSq&&t.vel.set(a.normalize().mult(this._cap))}}exports.CapVelocity=a;class c extends a{constructor(t){super(t)}apply(t){t.acceleration.magSq()>this.capSq&&(t.acceleration.normalize(),t.acceleration.mult(this.cap))}}exports.CapAcceleration=c;class s extends t.Behavior{constructor(t=0){super(),this.cap=t}apply(t){const e=t.deltaRotation;if(Math.abs(e)>this.cap){const a=Math.sign(e)*this.cap-e;t.rotate(a)}}}exports.CapRotation=s;
},{"./behavior":"O8qb","../util/vec":"LpCL"}],"E0J5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class a{constructor(){this.callbacks=[],this.entities=[],this.background=[],this.foreground=[]}update(a){this.callbacks.forEach(s=>s(a)),this.entities.forEach(s=>{s.applyBehaviors(a),s.applyDeltas()})}draw(a,s){this.background.forEach(t=>t.draw(a,s)),this.entities.forEach(t=>{a.save(),a.translate(t.pos.x,t.pos.y),t.draw(a,s),a.restore()}),this.foreground.forEach(t=>t.draw(a,s))}addCallback(a){this.callbacks.push(a)}addEntity(a){this.entities.push(a)}addBackgroundDrawable(a){this.addDrawable(this.background,a)}addForegroundDrawable(a){this.addDrawable(this.foreground,a)}addDrawable(a,s){"function"==typeof s&&(s={draw:s}),a.push(s)}}exports.World=a;
},{}],"F5sE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("../util/vec"),s=require("../env");class e{constructor(s){this.world=s,this.lastTime=0,this.boundTick=this.tick.bind(this),this.slide=new t.Vec(0,0),window.addEventListener("resize",this.resize.bind(this)),document.addEventListener("contextmenu",t=>t.preventDefault()),this.setCanvas(),this.tick()}tick(){const t=Date.now();let s=(t-this.lastTime)/1e3;this.lastTime=t,s>.05&&(s=.05),this.world.update(s),this.draw(s),requestAnimationFrame(this.boundTick)}setCanvas(){this.canvas=document.getElementById("canvas");const t=this.canvas.getContext("2d");t&&(this.g=t),this.resize(),this.clear()}draw(t){this.clear(),this.g.save(),this.g.translate(this.slide.x,this.slide.y),this.g.scale(s.Env.scale,s.Env.scale),this.world.draw(this.g,t),this.g.restore()}resize(){const t=this.canvas.clientWidth,e=this.canvas.clientHeight;this.canvas.width=t,this.canvas.height=e;let i=1;t>s.Env.REQ_SIZE.x&&(i=t/s.Env.REQ_SIZE.x),e>s.Env.REQ_SIZE.y&&(i=Math.max(i,e/s.Env.REQ_SIZE.y)),1===i&&(s.Env.REQ_SIZE.x>t||s.Env.REQ_SIZE.y>e)&&(i=Math.max(t/s.Env.REQ_SIZE.x,e/s.Env.REQ_SIZE.y)),s.Env.scale=Math.max(i,.75)}clear(){this.g.fillStyle="#C0C0C0",this.g.fillRect(0,0,this.canvas.width,this.canvas.height)}}exports.Graphics=e;
},{"../util/vec":"LpCL","../env":"m88C"}],"ayJ6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../util/vec"),t=require("../env");class s{constructor(e){this.game=e,window.addEventListener("mousedown",this.down.bind(this)),window.addEventListener("mouseup",this.up.bind(this)),window.addEventListener("mousemove",this.move.bind(this)),window.addEventListener("keydown",this.keyDown.bind(this)),window.addEventListener("keyup",this.keyUp.bind(this))}keyDown(e){16===e.keyCode?(t.Env.shifting=!0,delete this.lastAdjust):"r"===e.key?this.game.reset():"m"===e.key&&this.game.maze()}keyUp(e){16===e.keyCode&&(delete this.lastAdjust,t.Env.shifting=!1)}down(e){void 0===this.mouseDown&&(this.mouseDown=e.button,2===this.mouseDown?this.dragRight(e):0===this.mouseDown&&this.drag(e))}up(e){delete this.lastAdjust,this.mouseDown===e.button&&delete this.mouseDown}move(e){0===this.mouseDown?this.drag(e):2===this.mouseDown&&this.dragRight(e),this.game.highlight(e.clientX/t.Env.scale,e.clientY/t.Env.scale)}drag(s){const i=s.clientX/t.Env.scale,n=s.clientY/t.Env.scale;this.game.setNode(i,n,this.lastAdjust),this.lastAdjust=new e.Vec(i,n)}dragRight(e){this.game.setGoal(e.clientX/t.Env.scale,e.clientY/t.Env.scale)}}exports.Input=s,s.moveDelta=new e.Vec;
},{"../util/vec":"LpCL","../env":"m88C"}],"B7Qg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class r{constructor(r){this.grid=r}draw(r){this.grid.forEach(s=>{s.forEach(s=>{s.valid||(r.save(),r.translate(s.pos.x,s.pos.y),s.draw(r),r.restore())})})}}exports.DrawGrid=r;
},{}],"klJe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./vec"),d=require("../env");class t{static prims(t){t.forEach(e=>e.forEach(e=>{e.valid=!1,e.clearEdges()}));for(let e=2;e<t[0].length;e++){t[0][e].doubleEdge(t[0][e-2],1);for(let d=2;d<t.length;d++)t[d][e].doubleEdge(t[d][e-2],1),t[d][e].doubleEdge(t[d-2][e],1)}for(let e=2;e<t.length;e++)t[e][0].doubleEdge(t[e-2][0],1);let o,l;do{o=new e.Vec(Math.random()*t[0].length,Math.random()*t.length).floor(),l=t[o.y][o.x]}while(l.pos.x*d.Env.scale>window.innerWidth||l.pos.y*d.Env.scale>window.innerHeight);l.valid=!0;const n=[],r=new Set;for(l.edges.forEach(e=>{n.push([e,l]),r.add(e)});n.length;){const d=Math.floor(Math.random()*n.length),o=n[d],l=o[0];n[d]=n[n.length-1],n.length--,l.valid=!0;const a=e.Vec.add(l.index,o[1].index).div(2);t[a.y][a.x].valid=!0,l.edges.forEach(e=>{e.valid||r.has(e)||(n.push([e,l]),r.add(e))})}return l}}exports.Maze=t;
},{"./vec":"LpCL","../env":"m88C"}],"jP6t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./util/vec"),t=require("./util/util"),s=require("./graphs/node"),i=require("./entities/boid"),o=require("./behaviors/seek-target"),h=require("./graphs/algorithm"),n=require("./behaviors/crumbs"),d=require("./behaviors/velocity-align"),r=require("./behaviors/caps"),a=require("./world"),l=require("./ui/graphics"),g=require("./ui/input"),c=require("./ui/draw-grid"),u=require("./env"),f=require("./util/maze");class v{constructor(){this.xOff=0,this.yOff=0,this.world=new a.World,this.smoothing=!0,this.initGrid(),this.boid=new i.Boid(new e.Vec(200,200)),this.seekTarget=new o.SeekTarget(new e.Vec(200,200),1),this.crumbs=new n.BreadCrumbs(35,35),this.boid.setBehaviors(this.crumbs,this.seekTarget,new d.AlignToVelocity,new r.CapAcceleration(.3),new r.CapRotation(t.Util.radians(6)),new r.CapVelocity(1.2)),this.world.addCallback(this.reTarget.bind(this)),this.world.addBackgroundDrawable(this.crumbs),this.world.addBackgroundDrawable(this.drawPathing.bind(this)),this.world.addEntity(this.boid),this.world.addForegroundDrawable(new c.DrawGrid(this.nodes)),new g.Input(this),new l.Graphics(this.world)}initGrid(){this.nodes=[];for(let t=0;t<u.Env.GRID_DIM.y;t++){const i=[];for(let o=0;o<u.Env.GRID_DIM.x;o++){const h=new e.Vec(u.Env.HALF_GRID_SIZE+o*u.Env.GRID_SIZE,u.Env.HALF_GRID_SIZE+t*u.Env.GRID_SIZE);i.push(new s.GraphNode(new e.Vec(o,t),h))}this.nodes.push(i)}this.setEdges()}setEdges(){this.nodes.forEach(e=>e.forEach(e=>e.clearEdges()));for(let e=0;e<u.Env.GRID_DIM.y;e++)for(let t=0;t<u.Env.GRID_DIM.x;t++){const s=this.nodes[e][t];s.valid&&(e>0&&this.nodes[e-1][t].valid&&s.doubleEdge(this.nodes[e-1][t],s.pos.dist(this.nodes[e-1][t].pos)),t>0&&(this.nodes[e][t-1].valid&&s.doubleEdge(this.nodes[e][t-1],s.pos.dist(this.nodes[e][t-1].pos)),e>0&&this.nodes[e-1][t-1].valid&&this.nodes[e][t-1].valid&&this.nodes[e-1][t].valid&&s.doubleEdge(this.nodes[e-1][t-1],s.pos.dist(this.nodes[e-1][t-1].pos)),e<u.Env.GRID_DIM.y-1&&this.nodes[e+1][t-1].valid&&this.nodes[e+1][t].valid&&this.nodes[e][t-1].valid&&s.doubleEdge(this.nodes[e+1][t-1],s.pos.dist(this.nodes[e+1][t-1].pos))))}}solve(){if(!this.goal)return;const e=this.boidNode;e&&(this.goal===this.boidNode?(this.seekTarget.target=this.fineGoal,delete this.algo):(this.algo=new h.Algorithm(e,this.goal),this.algo.solve()))}setGoal(t,s){const i=this.worldToIndex(t,s);if(!i)return;const o=this.getNode(i);o.valid&&(this.goal=o,this.fineGoal=new e.Vec(t,s),this.solve())}getNode(e){return this.nodes[e.y][e.x]}setNode(t,s,i){const o=this.worldToIndex(t,s);if(null==o)return;let h,n=[this.getNode(o)];i&&(h=this.worldToIndex(i.x,i.y))&&h.dist(o)>=2&&(n=this.getNodesOnLine(i,new e.Vec(t,s),!1));let d=!1;for(const e of n)!u.Env.shifting&&this.boidNode&&this.boidNode.pos.dist(e.pos)<2*u.Env.GRID_SIZE||e!==this.goal&&e.valid!==u.Env.shifting&&(e.valid=u.Env.shifting,d=!0);d&&(this.setEdges(),this.solve())}worldToIndex(t,s){if(t<0||t>=u.Env.GRID_DIM.x*u.Env.GRID_SIZE||s<0||s>=u.Env.GRID_DIM.y*u.Env.GRID_SIZE)return;const i=Math.floor((t-this.xOff)/u.Env.GRID_SIZE),o=Math.floor((s-this.yOff)/u.Env.GRID_SIZE);return i<0||o<0||i>=u.Env.GRID_DIM.x||o>=u.Env.GRID_DIM.y?void 0:new e.Vec(i,o)}screenToNode(e){const t=this.worldToIndex(e.x,e.y);if(t)return this.nodes[t.y][t.x]}get boidNode(){return this.screenToNode(this.boid.pos)}reTarget(){const e=this.boidNode;if(this.seekTarget.target=this.boid.pos,this.fineGoal&&this.algo&&this.algo.path)if(this.smoothing){let e=this.getNodesOnLine(this.boid.pos,this.fineGoal);if(t.Util.rayCast(this.boid.pos,this.fineGoal,this.boid.radius,e))for(let s=this.algo.path.length-1;s>=0;s--){const i=this.algo.path[s].pos;if(e=this.getNodesOnLine(this.boid.pos,i),!t.Util.rayCast(this.boid.pos,i,this.boid.radius,e)){this.seekTarget.target=i;break}}else this.seekTarget.target=this.fineGoal}else for(let t=0;t<this.algo.path.length-1;t++){const s=this.algo.path[t],i=this.algo.path[t+1];s==e&&(i==this.goal?this.seekTarget.target=this.fineGoal:this.seekTarget.target=i.pos)}}drawPathing(t){if(this.fineGoal){if(this.algo&&this.algo.path){t.strokeStyle="#FFFF00";let e=this.algo.path[0].pos;for(let s=1;s<this.algo.path.length;s++){let i=this.algo.path[s].pos;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(i.x,i.y),t.stroke(),e=i}this.smoothing&&(t.strokeStyle="red",t.beginPath(),t.moveTo(this.boid.pos.x,this.boid.pos.y),t.lineTo(this.seekTarget.target.x,this.seekTarget.target.y),t.stroke())}t.fillStyle="#C96500",t.beginPath(),t.ellipse(this.fineGoal.x,this.fineGoal.y,4,4,0,0,e.Vec.TWO_PI),t.fill()}}reset(){this.nodes.forEach(e=>e.forEach(e=>{e.valid=!0})),this.crumbs.clear(),this.setEdges(),this.solve()}maze(){delete this.fineGoal,delete this.algo;const e=f.Maze.prims(this.nodes);this.boid.pos.set(e.pos),this.seekTarget.target=e.pos,this.crumbs.clear(),this.setEdges()}highlight(t,s){const i=this.screenToNode(new e.Vec(t,s));i?u.Env.highlight=i:delete u.Env.highlight}getNodesOnLine(e,t,s=!0){const i=new Set;let o=this.worldToIndex(e.x,e.y),h=this.worldToIndex(t.x,t.y);if(!o||!h)return i;const n=o.x-h.x,d=o.y-h.y;if(0==n)for(let r=Math.min(o.y,h.y);r<=Math.max(o.y,h.y);r++)s?this.addSurroundingObstacles(o.x,r,i):i.add(this.nodes[r][o.x]);else{let e=0;const t=Math.abs(d/n);if(o.x>h.x){const e=o;o=h,h=e}let r=o.y;const a=Math.sign(h.y-o.y);for(let n=o.x;n<=h.x;n++)for(s?this.addSurroundingObstacles(n,r,i):i.add(this.nodes[r][n]),e+=t;e>=.5;)s?this.addSurroundingObstacles(n,r,i):i.add(this.nodes[r][n]),r+=a,e-=1}return i}addSurroundingObstacles(e,t,s){for(let i=e-1;i<=e+1;i++)for(let e=t-1;e<=t+1;e++)i>=0&&i<u.Env.GRID_DIM.x&&e>=0&&e<u.Env.GRID_DIM.y&&!this.nodes[e][i].valid&&s.add(this.nodes[e][i])}}exports.Game=v,new v;
},{"./util/vec":"LpCL","./util/util":"oVEU","./graphs/node":"Yf8M","./entities/boid":"ZD7m","./behaviors/seek-target":"Wd1d","./graphs/algorithm":"d3Yy","./behaviors/crumbs":"f1UR","./behaviors/velocity-align":"LsDi","./behaviors/caps":"a041","./world":"E0J5","./ui/graphics":"F5sE","./ui/input":"ayJ6","./ui/draw-grid":"B7Qg","./env":"m88C","./util/maze":"klJe"}]},{},["jP6t"], null)